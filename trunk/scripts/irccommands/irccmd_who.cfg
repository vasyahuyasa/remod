// list players
irccmd_who = [
	if (> (numclients) 0) [
		all = (allplayers)          
		
		pcount = (format "Total: %1/%2" (numclients) $maxclients)
		plays = "" 
		specs = "" 
		
		looplist cn $all [
			if (isspectator $cn) [
				specs = (listadd $specs (format "%1(%2)" (concatword (ircgreen (getname $cn)) (ircdgrey "")) $cn))
			] [
				plays = (listadd $plays (format "%1(%2)" (concatword (ircgreen (getname $cn)) (ircdgrey "")) $cn))
			]
		]
		
		if (!=s $plays "") [ plays = (concat "Players:" (unescape (prettylist $plays))) ] 
		if (!=s $specs "") [ specs = (concat "Spectators:" (unescape (prettylist $specs))) ]
		 
		ircsay  (concat $pcount $plays $specs)		
	] [
		ircsay "No one connected"
	] 		                                                           	
]

irc_registercommand "who" irccmd_who 0 "" "List players" 
